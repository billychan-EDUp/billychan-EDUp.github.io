<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>倍數與因數 概念模擬器 | Multiples & Factors Simulator</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Custom scrollbar for mobile neatness */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Fix icon alignment */
        .lucide {
            vertical-align: middle;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans">

<div id="root"></div>

<script type="text/babel">

const { useState, useEffect } = React;

// --- Helper for Icons in HTML mode ---
// Wraps the lucide <i> tag to play nicely with React re-renders
const Icon = ({ name, className }) => {
    return <i data-lucide={name} className={className}></i>;
};

// --- Language Data ---
const content = {
    zh: {
        title: "倍數與因數 概念模擬器",
        subtitle: "視覺化學習工具",
        tab_multiples_intro: "公倍數介紹",
        tab_lcm_tool: "找最小公倍數",
        tab_factors_intro: "公因數介紹",
        tab_hcf_tool: "找最大公因數",
        
        // Multiples Intro
        m_intro_title: "什麼是公倍數？",
        m_def_1: "倍數 (Multiple)",
        m_def_1_desc: "一個整數能夠被另一個整數整除，這個整數就是另一整數的倍數。例如：3 的倍數有 3, 6, 9, 12...",
        m_def_2: "公倍數 (Common Multiple)",
        m_def_2_desc: "兩個或兩個以上整數共同的倍數。",
        m_def_3: "最小公倍數 (LCM)",
        m_def_3_desc: "在公倍數中，數值最小的那一個（不包含 0）。",
        
        // LCM Tool
        lcm_tool_title: "列舉法找 LCM",
        input_label_1: "數字 A",
        input_label_2: "數字 B",
        calc_btn: "開始列舉",
        step_1: "1. 列出倍數 (取前 10 個)",
        step_2: "2. 找出共同的數 (公倍數)",
        step_3: "3. 找出最小公倍數 (LCM)",
        result_lcm: "最小公倍數是：",
        no_common: "在前 10 個倍數中未找到公倍數，請嘗試較小的數字。",

        // Factors Intro
        f_intro_title: "什麼是公因數？",
        f_def_1: "因數 (Factor)",
        f_def_1_desc: "能將一個數整除的數。例如：12 的因數有 1, 2, 3, 4, 6, 12。",
        f_def_2: "公因數 (Common Factor)",
        f_def_2_desc: "兩個或兩個以上整數共同的因數。",
        f_def_3: "最大公因數 (HCF/GCD)",
        f_def_3_desc: "在公因數中，數值最大的那一個。",

        // HCF Tool
        hcf_tool_title: "列舉法找 HCF",
        hcf_step_1: "1. 列出所有因數",
        hcf_step_2: "2. 找出共同的數 (公因數)",
        hcf_step_3: "3. 找出最大公因數 (HCF)",
        result_hcf: "最大公因數是：",
        
        footer: "數學概念模擬器 © 2024"
    },
    en: {
        title: "Multiples & Factors Simulator",
        subtitle: "Visual Learning Tool",
        tab_multiples_intro: "Intro to Multiples",
        tab_lcm_tool: "Find LCM",
        tab_factors_intro: "Intro to Factors",
        tab_hcf_tool: "Find HCF",

        // Multiples Intro
        m_intro_title: "What are Common Multiples?",
        m_def_1: "Multiple",
        m_def_1_desc: "Product of a number and an integer. E.g., Multiples of 3 are 3, 6, 9, 12...",
        m_def_2: "Common Multiple",
        m_def_2_desc: "Multiples that are shared by two or more numbers.",
        m_def_3: "Least Common Multiple (LCM)",
        m_def_3_desc: "The smallest common multiple (excluding zero).",

        // LCM Tool
        lcm_tool_title: "Finding LCM by Listing",
        input_label_1: "Number A",
        input_label_2: "Number B",
        calc_btn: "List & Find",
        step_1: "1. List Multiples (First 10)",
        step_2: "2. Find Common Multiples",
        step_3: "3. Find LCM",
        result_lcm: "The LCM is:",
        no_common: "No common multiples found in the first 10 terms. Try smaller numbers.",

        // Factors Intro
        f_intro_title: "What are Common Factors?",
        f_def_1: "Factor",
        f_def_1_desc: "Numbers that divide exactly into another number. E.g., Factors of 12 are 1, 2, 3, 4, 6, 12.",
        f_def_2: "Common Factor",
        f_def_2_desc: "Factors that are shared by two or more numbers.",
        f_def_3: "Highest Common Factor (HCF)",
        f_def_3_desc: "The largest of the common factors.",

        // HCF Tool
        hcf_tool_title: "Finding HCF by Listing",
        hcf_step_1: "1. List All Factors",
        hcf_step_2: "2. Find Common Factors",
        hcf_step_3: "3. Find HCF",
        result_hcf: "The HCF is:",

        footer: "Math Concept Simulator © 2024"
    }
};

// --- Components ---

const Card = ({ children, className = "" }) => (
    <div className={`bg-white rounded-xl shadow-md p-4 mb-4 border border-slate-100 ${className}`}>
        {children}
    </div>
);

const NumberBadge = ({ num, isHighlight, isResult }) => {
    let baseClass = "inline-flex items-center justify-center w-8 h-8 m-1 rounded-full text-sm font-bold transition-all duration-300";
    if (isResult) {
        return <span className={`${baseClass} bg-yellow-400 text-yellow-900 scale-110 shadow-lg ring-2 ring-yellow-200`}>{num}</span>;
    }
    if (isHighlight) {
        return <span className={`${baseClass} bg-indigo-100 text-indigo-700 ring-2 ring-indigo-400`}>{num}</span>;
    }
    return <span className={`${baseClass} bg-slate-100 text-slate-600`}>{num}</span>;
};

const IntroSection = ({ langData, type }) => {
    const isMultiple = type === 'multiple';
    const accentColor = isMultiple ? "text-blue-600" : "text-green-600";
    const bgIcon = isMultiple ? "bg-blue-100" : "bg-green-100";
    const iconName = isMultiple ? "layers" : "puzzle";

    return (
        <div className="fade-in space-y-6">
            <div className="text-center py-6">
                <div className={`mx-auto w-16 h-16 ${bgIcon} rounded-full flex items-center justify-center mb-4`}>
                    <Icon name={iconName} className={`w-8 h-8 ${accentColor}`} />
                </div>
                <h2 className="text-2xl font-bold text-slate-800">
                    {isMultiple ? langData.m_intro_title : langData.f_intro_title}
                </h2>
            </div>

            <Card>
                <h3 className={`font-bold text-lg mb-2 ${accentColor}`}>{isMultiple ? langData.m_def_1 : langData.f_def_1}</h3>
                <p className="text-slate-600">{isMultiple ? langData.m_def_1_desc : langData.f_def_1_desc}</p>
            </Card>

            <Card>
                <h3 className={`font-bold text-lg mb-2 ${accentColor}`}>{isMultiple ? langData.m_def_2 : langData.f_def_2}</h3>
                <p className="text-slate-600">{isMultiple ? langData.m_def_2_desc : langData.f_def_2_desc}</p>
            </Card>

            <Card>
                <h3 className={`font-bold text-lg mb-2 ${accentColor}`}>{isMultiple ? langData.m_def_3 : langData.f_def_3}</h3>
                <p className="text-slate-600">{isMultiple ? langData.m_def_3_desc : langData.f_def_3_desc}</p>
            </Card>
        </div>
    );
};

const LCMTool = ({ langData }) => {
    const [num1, setNum1] = useState(4);
    const [num2, setNum2] = useState(6);
    const [result, setResult] = useState(null);

    const calculate = () => {
        const list1 = [];
        const list2 = [];
        // Generate first 10 multiples
        for(let i=1; i<=10; i++) list1.push(num1 * i);
        for(let i=1; i<=10; i++) list2.push(num2 * i);

        const common = list1.filter(value => list2.includes(value));
        const lcm = common.length > 0 ? Math.min(...common) : null;

        setResult({ list1, list2, common, lcm });
    };

    useEffect(() => { calculate(); }, []);

    return (
        <div className="fade-in">
            <h2 className="text-xl font-bold text-center mb-6 text-blue-700">{langData.lcm_tool_title}</h2>
            
            {/* Input Area */}
            <Card className="bg-blue-50 border-blue-100">
                <div className="flex gap-4 items-end">
                    <div className="flex-1">
                        <label className="block text-sm font-black text-blue-800 mb-1">{langData.input_label_1}</label>
                        <input 
                            type="number" value={num1} onChange={(e) => setNum1(Number(e.target.value))} 
                            className="w-full p-2 rounded-lg border-2 border-blue-200 text-center text-xl font-bold text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-colors"
                            min="1" max="50"
                        />
                    </div>
                    <div className="flex-1">
                        <label className="block text-sm font-black text-blue-800 mb-1">{langData.input_label_2}</label>
                        <input 
                            type="number" value={num2} onChange={(e) => setNum2(Number(e.target.value))} 
                            className="w-full p-2 rounded-lg border-2 border-blue-200 text-center text-xl font-bold text-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-400 transition-colors"
                            min="1" max="50"
                        />
                    </div>
                </div>
                <button 
                    onClick={calculate}
                    className="w-full mt-4 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 active:scale-95 transition-all shadow-lg shadow-blue-200">
                    {langData.calc_btn}
                </button>
            </Card>

            {/* Steps & Visualization */}
            {result && (
                <div className="space-y-4">
                    {/* Step 1 */}
                    <Card>
                        <h4 className="font-bold text-slate-500 text-sm mb-3">{langData.step_1}</h4>
                        <div className="flex flex-col gap-3">
                            <div className="flex flex-wrap items-center">
                                <div className="flex items-center justify-center bg-blue-100 text-blue-800 font-black rounded px-3 py-1 mr-2 min-w-[3rem] shadow-sm border border-blue-200">
                                    {num1}
                                </div>
                                <span className="mr-2 text-slate-300 font-bold">:</span>
                                {result.list1.map(n => (
                                    <NumberBadge key={n} num={n} isHighlight={result.common.includes(n)} isResult={n === result.lcm} />
                                ))}
                                <span className="text-slate-400 ml-1 font-bold">...</span>
                            </div>
                            <div className="border-t border-slate-100"></div>
                            <div className="flex flex-wrap items-center">
                                <div className="flex items-center justify-center bg-blue-100 text-blue-800 font-black rounded px-3 py-1 mr-2 min-w-[3rem] shadow-sm border border-blue-200">
                                    {num2}
                                </div>
                                <span className="mr-2 text-slate-300 font-bold">:</span>
                                {result.list2.map(n => (
                                    <NumberBadge key={n} num={n} isHighlight={result.common.includes(n)} isResult={n === result.lcm} />
                                ))}
                                <span className="text-slate-400 ml-1 font-bold">...</span>
                            </div>
                        </div>
                    </Card>

                    {/* Step 2 */}
                    <Card>
                        <h4 className="font-bold text-slate-500 text-sm mb-2">{langData.step_2}</h4>
                        <div className="flex flex-wrap">
                            {result.common.length > 0 ? result.common.map(n => (
                                <NumberBadge key={n} num={n} isHighlight={true} isResult={n === result.lcm} />
                            )) : <p className="text-sm text-red-500">{langData.no_common}</p>}
                        </div>
                    </Card>

                    {/* Step 3 - Result */}
                    {result.lcm && (
                        <div className="bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl p-6 text-white text-center shadow-lg shadow-blue-200 animate-bounce-slow">
                            <p className="text-blue-100 mb-1 font-medium">{langData.result_lcm} LCM</p>
                            <div className="text-5xl font-black tracking-tighter">{result.lcm}</div>
                        </div>
                    )}
                </div>
            )}
        </div>
    );
};

const HCFTool = ({ langData }) => {
    const [num1, setNum1] = useState(12);
    const [num2, setNum2] = useState(18);
    const [result, setResult] = useState(null);

    const getFactors = (n) => {
        const factors = [];
        for(let i=1; i<=n; i++) {
            if(n % i === 0) factors.push(i);
        }
        return factors;
    }

    const calculate = () => {
        const list1 = getFactors(num1);
        const list2 = getFactors(num2);
        const common = list1.filter(value => list2.includes(value));
        const hcf = common.length > 0 ? Math.max(...common) : 1;

        setResult({ list1, list2, common, hcf });
    };

    useEffect(() => { calculate(); }, []);

    return (
        <div className="fade-in">
            <h2 className="text-xl font-bold text-center mb-6 text-green-700">{langData.hcf_tool_title}</h2>
            
            {/* Input Area */}
            <Card className="bg-green-50 border-green-100">
                <div className="flex gap-4 items-end">
                    <div className="flex-1">
                        <label className="block text-sm font-black text-green-800 mb-1">{langData.input_label_1}</label>
                        <input 
                            type="number" value={num1} onChange={(e) => setNum1(Number(e.target.value))} 
                            className="w-full p-2 rounded-lg border-2 border-green-200 text-center text-xl font-bold text-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors"
                            min="1" max="100"
                        />
                    </div>
                    <div className="flex-1">
                        <label className="block text-sm font-black text-green-800 mb-1">{langData.input_label_2}</label>
                        <input 
                            type="number" value={num2} onChange={(e) => setNum2(Number(e.target.value))} 
                            className="w-full p-2 rounded-lg border-2 border-green-200 text-center text-xl font-bold text-green-700 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-green-400 transition-colors"
                            min="1" max="100"
                        />
                    </div>
                </div>
                <button 
                    onClick={calculate}
                    className="w-full mt-4 bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700 active:scale-95 transition-all shadow-lg shadow-green-200">
                    {langData.calc_btn}
                </button>
            </Card>

             {/* Steps & Visualization */}
             {result && (
                <div className="space-y-4">
                    {/* Step 1 */}
                    <Card>
                        <h4 className="font-bold text-slate-500 text-sm mb-3">{langData.hcf_step_1}</h4>
                        <div className="flex flex-col gap-3">
                            <div className="flex flex-wrap items-center">
                                <div className="flex items-center justify-center bg-green-100 text-green-800 font-black rounded px-3 py-1 mr-2 min-w-[3rem] shadow-sm border border-green-200">
                                    {num1}
                                </div>
                                <span className="mr-2 text-slate-300 font-bold">:</span>
                                {result.list1.map(n => (
                                    <NumberBadge key={n} num={n} isHighlight={result.common.includes(n)} isResult={n === result.hcf} />
                                ))}
                            </div>
                            <div className="border-t border-slate-100"></div>
                            <div className="flex flex-wrap items-center">
                                <div className="flex items-center justify-center bg-green-100 text-green-800 font-black rounded px-3 py-1 mr-2 min-w-[3rem] shadow-sm border border-green-200">
                                    {num2}
                                </div>
                                <span className="mr-2 text-slate-300 font-bold">:</span>
                                {result.list2.map(n => (
                                    <NumberBadge key={n} num={n} isHighlight={result.common.includes(n)} isResult={n === result.hcf} />
                                ))}
                            </div>
                        </div>
                    </Card>

                    {/* Step 2 */}
                    <Card>
                        <h4 className="font-bold text-slate-500 text-sm mb-2">{langData.hcf_step_2}</h4>
                        <div className="flex flex-wrap">
                            {result.common.map(n => (
                                <NumberBadge key={n} num={n} isHighlight={true} isResult={n === result.hcf} />
                            ))}
                        </div>
                    </Card>

                    {/* Step 3 - Result */}
                    <div className="bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-6 text-white text-center shadow-lg shadow-green-200 animate-bounce-slow">
                        <p className="text-green-100 mb-1 font-medium">{langData.result_hcf} HCF</p>
                        <div className="text-5xl font-black tracking-tighter">{result.hcf}</div>
                    </div>
                </div>
            )}
        </div>
    );
}

const App = () => {
    const [lang, setLang] = useState('zh');
    const [activeTab, setActiveTab] = useState('m_intro');
    const c = content[lang];

    // Re-render icons when DOM updates
    useEffect(() => {
        if (window.lucide) {
            window.lucide.createIcons();
        }
    });

    const tabs = [
        { id: 'm_intro', label: c.tab_multiples_intro, icon: 'book-open' },
        { id: 'lcm_tool', label: c.tab_lcm_tool, icon: 'calculator' },
        { id: 'f_intro', label: c.tab_factors_intro, icon: 'book-open' },
        { id: 'hcf_tool', label: c.tab_hcf_tool, icon: 'calculator' },
    ];

    return (
        <div className="min-h-screen flex flex-col max-w-md mx-auto bg-slate-50 shadow-2xl overflow-hidden relative border-x border-slate-200">
            
            {/* Header */}
            <header className="bg-white p-4 pt-6 pb-2 sticky top-0 z-10 border-b border-slate-100">
                <div className="flex justify-between items-center mb-4">
                    <div className="flex items-center gap-3">
                        {/* Logo Placeholder */}
                        <div className="w-10 h-10 overflow-hidden rounded-lg bg-slate-100 flex items-center justify-center shrink-0 relative">
                            <img 
                                src="logo.png" 
                                alt="Logo" 
                                className="w-full h-full object-cover relative z-10"
                                onError={(e) => {
                                    e.target.style.display = 'none';
                                }} 
                            />
                            {/* Fallback Icon */}
                             <div className="absolute inset-0 flex items-center justify-center z-0">
                                <Icon name="sigma" className="text-slate-400 w-6 h-6" />
                             </div>
                        </div>
                        <h1 className="font-bold text-lg leading-tight text-slate-800">
                            {c.title}
                            <span className="block text-xs text-slate-400 font-normal">{c.subtitle}</span>
                        </h1>
                    </div>
                    
                    {/* Language Switch */}
                    <div className="bg-slate-100 p-1 rounded-lg flex text-xs font-bold">
                        <button 
                            onClick={() => setLang('zh')} 
                            className={`px-3 py-1 rounded-md transition-all ${lang === 'zh' ? 'bg-white text-slate-800 shadow-sm' : 'text-slate-400'}`}>
                            中
                        </button>
                        <button 
                            onClick={() => setLang('en')} 
                            className={`px-3 py-1 rounded-md transition-all ${lang === 'en' ? 'bg-white text-slate-800 shadow-sm' : 'text-slate-400'}`}>
                            EN
                        </button>
                    </div>
                </div>

                {/* Tab Navigation (Horizontal Scrollable) */}
                <nav className="flex gap-2 overflow-x-auto no-scrollbar pb-2">
                    {tabs.map(tab => {
                        const isActive = activeTab === tab.id;
                        let colorClass = 'bg-slate-100 text-slate-500';
                        if (isActive) {
                             if(tab.id.includes('lcm') || tab.id.includes('m_')) colorClass = 'bg-blue-600 text-white shadow-md shadow-blue-200';
                             else colorClass = 'bg-green-600 text-white shadow-md shadow-green-200';
                        }
                        
                        return (
                            <button
                                key={tab.id}
                                onClick={() => setActiveTab(tab.id)}
                                className={`whitespace-nowrap px-4 py-2 rounded-full text-sm font-bold transition-all flex items-center gap-2 shrink-0 ${colorClass}`}
                            >
                                <Icon name={tab.icon} className="w-4 h-4 mr-2" />
                                {tab.label}
                            </button>
                        );
                    })}
                </nav>
            </header>

            {/* Main Content */}
            <main className="flex-1 p-4 pb-24 overflow-y-auto">
                {activeTab === 'm_intro' && <IntroSection langData={c} type="multiple" />}
                {activeTab === 'lcm_tool' && <LCMTool langData={c} />}
                {activeTab === 'f_intro' && <IntroSection langData={c} type="factor" />}
                {activeTab === 'hcf_tool' && <HCFTool langData={c} />}
            </main>

            {/* Footer */}
            <footer className="absolute bottom-0 w-full bg-slate-50 p-4 border-t border-slate-100 text-center text-xs text-slate-400">
                {c.footer}
            </footer>

        </div>
    );
};

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);

</script>
</body>
</html>
